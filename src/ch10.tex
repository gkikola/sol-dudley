\chapter{Primitive Roots}

\section{Exercises}

\Exercise1 What are the orders of $3$, $5$, and $7$, modulo $8$?
\begin{solution}
  Since $3^2\equiv1\pmod8$, $5^2\equiv1\pmod8$, and
  $7^2\equiv1\pmod8$, we see that each of these residues has order
  $2$.
\end{solution}

\Exercise2 What order can an integer have (mod $9$)? Find an example
of each.
\begin{solution}
  Since $\phi(9) = 3\cdot2 = 6$, the possible orders are $1$, $2$,
  $3$, and $6$. $1$ is the only integer with order $1$. $8$ has order
  $2$ since $8^2\equiv 1\pmod9$. $4$ has order $3$ since
  $4^2 \equiv 7\pmod9$ and $4^3\equiv1\pmod9$. And $2$ has order $6$,
  since $2^2\equiv4\pmod9$ and $2^3\equiv8\pmod9$.
\end{solution}

\Exercise3 Using the corollary to Theorem~3, what is the smallest
possible prime divisor of $2^{19} - 1$?
\begin{solution}
  By the corollary, any divisor can be written
  $2\cdot19k + 1 = 38k + 1$. The smallest numbers of this form are
  $1$, $39$, $77$, $115$, $153$, and $191$. The smallest possible
  prime divisor is therefore $191$. ($191$ is not a divisor, however,
  as $2^{19} - 1$ happens to be prime).
\end{solution}

\Exercise4 Show that $3$ is a primitive root of $7$.
\begin{solution}
  We get
  \begin{align*}
    3^1 &\equiv 3\pmod7, \\
    3^2 &\equiv 2\pmod7, \\
    3^3 &\equiv 6\pmod7, \\
    3^4 &\equiv 4\pmod7, \\
    3^5 &\equiv 5\pmod7, \\
    3^6 &\equiv 1\pmod7.
  \end{align*}
  Since $\phi(7) = 6$, $3$ is a primitive root of $7$.
\end{solution}

\Exercise5 Find, by trial, a primitive root of $10$.
\begin{solution}
  $\phi(10) = 4$. The powers of $3$ (mod $10$) are, respectively, $3$,
  $9$, $7$, and $1$, so $3$ is a primitive root of $10$. $7$ is also a
  primitive root.
\end{solution}

\Exercise6 Use the table of powers (mod $11$) at the beginning of this
section to verify that the corollary is true for $p = 11$.
\begin{solution}
  There is only one least residue with order $2$ (namely $10$), and
  $\phi(2) = 1$. There are $4$ residues with order $5$ ($3$, $4$, $5$,
  and $9$), and $\phi(5) = 4$. And there are $4$ residues with order
  $10$ ($2$, $6$, $7$, and $8$), and $\phi(10) = 4$. In each case the
  corollary holds.
\end{solution}

\Exercise7 Which of the integers $2, 3, \dots, 25$ do not have
primitive roots?
\begin{solution}
  The only integers with primitive roots are $1$, $2$, $4$, $p^e$, and
  $2p^e$ where $p$ is an odd prime. So $8$, $12$, $15$, $16$, $20$,
  $21$, and $24$ do not have primitive roots.
\end{solution}

\section{Problems}

\Problem1 Find the orders of $1, 2, \dots, 12$ (mod $13$).
\begin{solution}
  $1$ has order $1$. $12$ has order $2$. $3$ and $9$ have order
  $3$. $5$ and $8$ have order $4$. $4$ and $10$ have order $6$. $2$,
  $6$, $7$, and $11$ have order $12$.
\end{solution}

\Problem2 Find the orders of $1, 2, \dots, 16$ (mod $17$).
\begin{solution}
  $1$ has order $1$. $16$ has order $2$. $4$ and $13$ have order
  $4$. $2$, $8$, $9$, and $15$ have order $8$. $3$, $5$, $6$, $7$,
  $10$, $11$, $12$, and $14$ have order $16$.
\end{solution}

\Problem3 One of the primitive roots of $19$ is $2$. Find all of the
others.
\begin{solution}
  According to the corollary to Lemma~1, $2^k$ will be a primitive
  root of $19$ when $(k,18) = 1$. So the primitive roots are $2$,
  $2^5\equiv13$, $2^7\equiv14$, $2^{11}\equiv15$, $2^{13}\equiv3$, and
  $2^{17}\equiv10\pmod{19}$.
\end{solution}

\Problem4 One of the primitive roots of $23$ is $5$. Find all of the
others.
\begin{solution}
  $5^k$ should be a primitive root when $(k,22) = 1$. So the primitive
  roots are $5$, $5^3$, $5^5$, $5^7$, $5^9$, $5^{13}$, $5^{15}$,
  $5^{17}$, $5^{19}$, and $5^{21}$. Computing these powers, we find
  that the primitive roots are $7$, $10$, $11$, $14$, $15$, $17$,
  $19$, $20$, and $21$.
\end{solution}

\Problem5 What are the orders of $2$, $4$, $7$, $8$, $11$, $13$, and
$14$ (mod $15$)? Does $15$ have primitive roots?
\begin{solution}
  $4$, $11$, and $14$ have order $2$. $2$, $7$, $8$, and $13$ have
  order $4$. No integer has an order of $\phi(15) = 8$, so $15$ does
  not have primitive roots.
\end{solution}

\Problem6 What are the orders of $3$, $7$, $9$, $11$, $13$, $17$, and
$19$ (mod $20$)? Does $20$ have primitive roots?
\begin{solution}
  $9$, $11$, and $19$ have order $2$. $3$, $7$, $13$, and $17$ have
  order $4$. No integer has an order of $\phi(20) = 8$, so $20$ does
  not have primitive roots.
\end{solution}

\Problem7 Which integers have order $6$ (mod $31$)?
\begin{solution}
  By inspection, $6$ has order $6$ (mod $31$). As in the proof of
  Theorem~6, we can find the other integers with order $6$ by taking
  $6^k$ for $k$ such that $(k,6) = 1$. So the least residues having
  order $6$ are $6$ and $6^5\equiv26\pmod{31}$.
\end{solution}

\Problem8 Which integers have order $6$ (mod $37$)?
\begin{solution}
  $11$ has order $6$, so $11^5\equiv27\pmod{37}$ also has order $6$.
\end{solution}

\Problem9 If $a$, $a\neq1$, has order $t$ (mod $p$), show that
\begin{equation*}
  a^{t-1} + a^{t-2} + \cdots + 1 \equiv 0\pmod{p}.
\end{equation*}
\begin{proof}
  Since $a$ has order $t$, $a^t-1\equiv0\pmod{p}$. Then
  \begin{equation*}
    0\equiv a^t - 1 \equiv
    (a - 1)(a^{t-1} + a^{t-2} + \cdots + 1)\pmod{p}.
  \end{equation*}
  Since $p$ is prime and $a - 1\not\equiv0\pmod{p}$, we have
  \begin{equation*}
    a^{t-1} + a^{t-2} + \cdots + 1 \equiv 0\pmod{p}. \qedhere
  \end{equation*}
\end{proof}

\Problem{10} If $g$ and $h$ are primitive roots of an odd prime $p$,
then $g \equiv h^k\pmod{p}$ for some integer $k$. Show that $k$ is
odd.
\begin{proof}
  This follows from Lemma~1. $h$ has order $p - 1$, so $h^k$ has the
  same order if and only if $(k,p-1) = 1$. But since $p$ is an odd
  prime, if $k$ is even then $(k,p-1)\geq2$ and $g$ would not be a
  primitive root. Therefore $k$ must be odd.
\end{proof}

\Problem{11} Show that if $g$ and $h$ are primitive roots of an odd
prime $p$, then the least residue of $gh$ is not a primitive root of
$p$.
\begin{proof}
  Since $g$ and $h$ are both primitive roots, $h = g^k$ for some
  integer $k$. By the previous problem we know that $k$ must be
  odd. Then $gh = g^{k+1}$ cannot be a primitive root, because $k+1$
  is even.
\end{proof}

\Problem{12} If $g$, $h$, and $k$ are primitive roots of $p$, is the
least residue of $ghk$ always a primitive root of $p$?
\begin{solution}
  This is not true in general. For example, for $p = 23$, one can
  verify that $5$, $10$, and $17$ are primitive roots, but
  $5\cdot10\cdot17\equiv22\pmod{23}$ and $22$ is not a primitive root
  of $23$.
\end{solution}

\Problem{13} Show that if $a$ has order $3$ (mod $p$), then $a + 1$
has order $6$ (mod $p$).
\begin{proof}
  Rewriting $a^3 - 1\equiv0\pmod{p}$, we get
  $(a - 1)(a^2 + a + 1) \equiv 0\pmod{p}$, and since
  $a\not\equiv1\pmod{p}$, we get $a^2 + a + 1\equiv0\pmod{p}$. Then
  \begin{align*}
    (a + 1)^3
    &= a^3 + 3a^2 + 3a + 1 \\
    &\equiv 1 + 3a^2 + 3a + 1 \pmod{p} \\
    &\equiv 3(a^2 + a + 1) - 1 \pmod{p} \\
    &\equiv -1 \pmod{p}.
  \end{align*}
  Since $p > 2$ (because $a$ has order greater than $2$),
  $1\not\equiv-1\pmod{p}$ and we see that the order of $a+1$ is not
  $3$. But $(a+1)^6\equiv1\pmod{p}$ so the order of $a$ must divide
  $6$.

  The proof will be complete if we can show that $a+1$ does not have
  order $2$. Since
  \begin{align*}
    (a + 1)^2 &= a^2 + 2a + 1 \\
              &= (a^2 + a + 1) + a \\
              &\equiv a\pmod{p},
  \end{align*}
  we see that $a+1$ does not have order $2$. Therefore $a+1$ has order
  $6$.
\end{proof}

\Problem{14} If $p$ and $q$ are odd primes and $q\mid a^p + 1$, show
that either $q\mid a + 1$ or $q = 2kp + 1$ for some integer $k$.
\begin{proof}
  We know that $a^p\equiv-1\pmod{q}$, so the order of $a$ (mod $q$)
  cannot be $1$ or $p$. And since $a^{2p}\equiv1\pmod{q}$, the order
  of $a$ (mod $q$) is either $2$ or $2p$.

  If the order of $a$ is $2$, then $a\equiv-1\pmod{q}$ so
  $q\mid a + 1$.

  On the other hand, if the order of $a$ is $2p$, then
  $2p\mid\phi(q) = q - 1$ so that $q = 2kp + 1$.
\end{proof}
