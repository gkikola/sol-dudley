\chapter{Fermat's and Wilson's Theorems}

\section{Exercises}

\Exercise1 Verify that Fermat's Theorem is true for $a = 2$ and $p = 5$.
\begin{solution}
  We have $a^{p-1} = 2^4 = 16 \equiv 1 \pmod 5$, so the theorem holds.
\end{solution}

\Exercise2 Calculate $2^2$ and $20^{10}\pmod{11}$.
\begin{solution}
  $2^2\equiv4\pmod{11}$. To find $20^{10}$, we note that
  $20^2 = 400 \equiv 4\pmod{11}$. Squaring gives
  $20^4\equiv16\equiv5\pmod{11}$. Squaring again gives
  $20^8\equiv25\equiv3\pmod{11}$. So
  \begin{equation*}
    20^{10} = 20^8\cdot20^2 \equiv 3\cdot4 \equiv 1 \pmod{11}.\qedhere
  \end{equation*}
\end{solution}

\Exercise3 In the proof of Wilson's Theorem, what are the pairs when
$p = 11$?
\begin{solution}
  To find the multiplicative inverse of $2$, we look for the least
  residue satisfying the congruence $2x\equiv1\pmod{11}$. Since
  $1\equiv12\pmod{11}$, we may divide by $2$ to get
  $x\equiv6\pmod{11}$. Hence $(2,6)$ is one such pair. In the same way
  we can find the remaining pairs. The complete list of pairs follows:
  \begin{equation*}
    (2,6), (3,4), (5,9), (7,8). \qedhere
  \end{equation*}
\end{solution}

\section{Problems}

\Problem1 What is the least residue of
\begin{equation*}
  5^6\pmod7 \qquad 5^8\pmod7 \qquad 1945^8\pmod7?
\end{equation*}
\begin{solution}
  By Fermat's Theorem, $5^6\equiv1\pmod7$.

  $5^8 = 5^6\cdot5^2 \equiv 1\cdot4 \equiv 4\pmod7$.

  Again by Fermat, $1945^6\equiv1\pmod7$. Therefore
  \begin{equation*}
    1945^8\equiv1945^2
    = 5^2\cdot389^2 \equiv 4\cdot4^2 = 64\equiv1\pmod7.
    \qedhere
  \end{equation*}
\end{solution}

\Problem2 What is the least residue of
\begin{equation*}
  5^{10}\pmod{11} \qquad 5^{12}\pmod{11} \qquad 1945^{12}\pmod{11}?
\end{equation*}
\begin{solution}
  $5^{10}\equiv1\pmod{11}$ by Fermat's Theorem. So
  $5^{12} \equiv 5^2 \equiv 3\pmod{11}$.

  By Fermat, $1945^{10}\equiv1\pmod{11}$, so
  $1945^{12}\equiv1945^2\equiv9^2\equiv4\pmod{11}$.
\end{solution}

\Problem3 What is the last digit of $7^{355}$?
\begin{solution}
  We wish to find the least residue of $7^{355}$ modulo $10$. Note
  that $7^2 = 49 \equiv 9\pmod{10}$ and
  $7^4\equiv81\equiv1\pmod{10}$. So we have
  \begin{equation*}
    7^{355} = (7^4)^{88}\cdot7^3 \equiv 7^3 \equiv 3 \pmod {10}.
  \end{equation*}
  Therefore the last digit of $7^{355}$ is $3$.
\end{solution}

\Problem4 What are the last two digits of $7^{355}$?
\begin{solution}
  This is handled similarly to the previous problem, except now we are
  working modulo $100$. $7^3 = 343 \equiv 43\pmod{100}$, so
  $7^4\equiv301\equiv1\pmod{100}$. We find
  \begin{equation*}
    7^{355} = (7^4)^{88}\cdot7^3 \equiv 7^3 \equiv 43\pmod{100}.
  \end{equation*}
  The last two digits are therefore $4$ and $3$.
\end{solution}

\Problem5 What is the remainder when $314^{162}$ is divided by $163$?
\begin{solution}
  Since $314$ is not a multiple of $163$, which is prime, we may apply
  Fermat's Theorem to see that $314^{162}\equiv1\pmod{163}$.
\end{solution}

\Problem6 What is the remainder when $314^{162}$ is divided by $7$?
\begin{solution}
  As in the previous problem, since we know $314$ is not a multiple of
  $7$, we have by Fermat that $314^6\equiv1\pmod7$. Therefore
  \begin{equation*}
    314^{162} = (314^6)^{27} \equiv 1\pmod7. \qedhere
  \end{equation*}
\end{solution}

\Problem7 What is the remainder when $314^{164}$ is divided by $165$?
\begin{solution}
  Note that $165 = 3\cdot5\cdot11$. And we have
  \begin{align*}
    314^{164}\equiv2^{164}\equiv(2^4)^{41} &\equiv 1\pmod3, \\
    314^{164}\equiv4^{164}\equiv(4^4)^{41} &\equiv 1\pmod5, \\
    \intertext{and}
    314^{164}\equiv6^{164}\equiv(6^4)^{41} &\equiv 9\pmod{11}.
  \end{align*}
  We may now use the Chinese Remainder Theorem to solve the system of
  congruences given by
  \begin{equation*}
    x \equiv 1\pmod{15} \qquad\text{and}\qquad x \equiv 9 \pmod{11}.
  \end{equation*}
  This system admits the unique solution
  $x\equiv31\pmod{165}$. Therefore $31$ is the remainder we seek.
\end{solution}

\Problem8 What is the remainder when $2001^{2001}$ is divided by $26$?
\begin{solution}
  Since $2001\equiv25\equiv-1\pmod{26}$ we have
  \begin{equation*}
    2001^{2001}\equiv(-1)^{2001}\equiv-1\equiv25\pmod{26}.
  \end{equation*}
  Therefore the remainder is $25$.
\end{solution}

\Problem9 Show that
\begin{equation*}
  (p - 1)(p - 2)\cdots(p - r) \equiv (-1)^rr!\pmod p,
\end{equation*}
for $r = 1, 2, \dots, p - 1$.
\begin{proof}
  Fix an integer $p > 1$. We will prove the statement for all positive
  $r$ using induction on $r$. When $r = 1$, we have
  $p - 1 \equiv -1 \pmod{p}$, and certainly $-1 = (-1)^1(1!)$, so the
  statement holds in the base case.

  Now, suppose the statement holds for $r = k$ with
  $k\geq1$. Then $p - k - 1\equiv -(k + 1)\pmod{p}$ and we have
  \begin{equation*}
    (p - 1)\cdots(p - k)(p - k - 1)
    \equiv-(-1)^kk!(k + 1) \equiv (-1)^{k+1}(k+1)!\pmod{p}.
  \end{equation*}
  Therefore the statement holds for $r = k + 1$, which completes the
  proof.
\end{proof}

\Problem{10}
\begin{enumerate}
\item Calculate $(n - 1)!\pmod{n}$ for $n = 10$, $12$, $14$, and $15$.
  \begin{solution}
    Since $9!$ contains both a factor of $2$ and a factor of $5$, it
    follows that $9!\equiv0\pmod{10}$. For exactly the same reason, we
    get
    \begin{align*}
      11!&\equiv0\pmod{12}, \\
      13!&\equiv0\pmod{14}, \\
      \intertext{and}
      14!&\equiv0\pmod{15}. \qedhere
    \end{align*}
  \end{solution}
\item Guess a theorem and prove it.
  \begin{solution}
    The above calculations seem to suggest that
    $(n - 1)!\equiv0\pmod{n}$ when $n$ is composite, but we will have
    to exclude $n = 4$ since it would otherwise be a counterexample.

    So, we will show that
    \begin{equation*}
      (n - 1)!\equiv0\pmod{n}
      \quad\text{if and only if $n > 4$ is composite}.
    \end{equation*}
    The left-to-right implication is a consequence of Wilson's
    Theorem, so we will only need to prove the right-to-left
    direction.

    Assume that $n > 4$ and $n = ab$ where $1 < a < n$. There are two
    cases. First, if $a$ and $b$ are distinct, then $(n-1)!$ must
    contain both $a$ and $b$ as factors, so that $n\mid(n -
    1)!$. Therefore $(n-1)!\equiv0\pmod{n}$ in this case. The other
    possibility is that $a = b$, so that $n = a^2$. In this case,
    since $n > 4$, we know $a > 2$. Both $a$ and $2a$ will occur as
    separate factors in the expansion of $(n-1)!$, so again we have
    $n\mid(n-1)!$. In either case, $(n-1)!\equiv0\pmod{n}$.
  \end{solution}
\end{enumerate}

\Problem{11} Show that $2(p - 3)! + 1 \equiv 0 \pmod p$.
\begin{proof}
  We will suppose that $p$ is an odd prime. By Wilson's Theorem, we
  know that $(p - 1)!\equiv-1\pmod{p}$. Therefore
  \begin{equation*}
    (p - 1)(p - 2)(p - 3)! + 1 \equiv 0 \pmod{p}.
  \end{equation*}
  But $(p - 1)(p - 2)\equiv(-1)(-2)\equiv2\pmod{p}$. This gives the
  desired result.
\end{proof}

\Problem{12} In 1732 Euler wrote: ``I derived [certain] results from
the elegant theorem, of whose truth I am certain, although I have no
proof: $a^n - b^n$ is divisible by the prime $n + 1$ if neither $a$
nor $b$ is.'' Prove this theorem, using Fermat's Theorem.
\begin{proof}
  If $n + 1$ is prime, then Fermat's Theorem says that
  \begin{equation*}
    a^n\equiv b^n\equiv1\pmod{n+1},
  \end{equation*}
  provided that neither $a$ nor $b$ is a multiple of $n+1$. Therefore
  $a^n - b^n\equiv1 - 1\equiv0\pmod{n+1}$, which is equivalent to the
  statement that $n+1$ divides $a^n - b^n$.
\end{proof}

\Problem{13} Note that
\begin{align*}
  6! &\equiv -1 \pmod7, \\
  5!1! &\equiv \phantom{-}1 \pmod7, \\
  4!2! &\equiv -1 \pmod7, \\
  3!3! &\equiv \phantom{-}1 \pmod7.
\end{align*}
Try the same sort of calculation (mod $11$).
\begin{solution}
  Doing the calculations, we get
  \begin{align*}
    10! &\equiv -1\pmod{11}, \\
    9!1! &\equiv \phantom{-}1\pmod{11}, \\
    8!2! &\equiv -1\pmod{11}, \\
    7!3! &\equiv \phantom{-}1\pmod{11}, \\
    6!4! &\equiv -1\pmod{11}, \\
    5!5! &\equiv \phantom{-}1\pmod{11}. \qedhere
  \end{align*}
\end{solution}

\Problem{14} Guess a theorem from the data of Problem~13, and prove
it.
\begin{solution}
  The calculations seem to suggest that, for any odd prime $p$,
  \begin{equation*}
    (p - n)!(n - 1)! \equiv (-1)^n \pmod{p},
    \quad\text{for}\quad
    1\leq n\leq\frac{p+1}2.
  \end{equation*}
  For the proof, we use an inductive argument. The case where $n = 1$
  is simply Wilson's Theorem. So assume it holds for $n = k$, where
  $1\leq k<(p+1)/2$. Then
  \begin{equation*}
    (p - k)!(k - 1)! \equiv (-1)^k \pmod{p}.
  \end{equation*}
  Rewriting the left-hand side, we get
  \begin{equation*}
    (p - k)(p - k - 1)!(k - 1)! \equiv (-1)^k\pmod{p}.
  \end{equation*}
  Finally, since $p - k \equiv -k\pmod{p}$, we may multiply both sides
  by $-1$ to get
  \begin{equation*}
    (p - k - 1)!k! \equiv (-1)^{k+1}\pmod{p}.
  \end{equation*}
  This shows that the statement holds for all $n$ with
  $n = 1, 2, \dots, (p+1)/2$.
\end{solution}

\Problem{15} Suppose that $p$ is an odd prime.
\begin{enumerate}
\item Show that
  \begin{equation*}
    1^{p-1} + 2^{p-1} + \cdots + (p - 1)^{p-1} \equiv -1 \pmod{p}.
  \end{equation*}
  \begin{proof}
    By Fermat's Theorem, we have
    \begin{align*}
      1^{p-1} + 2^{p-1} + \cdots + (p - 1)^{p-1}
      &\equiv \overbrace{1 + 1 + \cdots + 1}^{\text{$p - 1$ terms}} \pmod{p} \\
      &\equiv p - 1 \pmod{p} \\
      &\equiv -1 \pmod{p}. \qedhere
    \end{align*}
  \end{proof}

\item Show that
  \begin{equation*}
    1^p + 2^p + \cdots + (p - 1)^p \equiv 0 \pmod{p}.
  \end{equation*}
  \begin{proof}
    Again, by Fermat we have $a^p\equiv a\pmod{p}$ for all $a$. So
    \begin{align*}
      1^p + 2^p + \cdots + (p-1)^p
      &\equiv 1 + 2 + \cdots + (p - 1) \pmod{p} \\
      &\equiv \frac{p(p - 1)}2 \pmod{p}.
    \end{align*}
    But $(p - 1) / 2$ is an integer, so $p$ divides the right-hand
    side. Hence
    \begin{equation*}
      1^p + \cdots + (p - 1)^p \equiv 0\pmod{p}. \qedhere
    \end{equation*}
  \end{proof}
\end{enumerate}

\Problem{16} Show that the converse of Fermat's Theorem is false.
\begin{solution}
  We need to show that there exist integers $a$ and $n$ with
  $(a,n) = 1$ and $a^{n-1}\equiv1\pmod{n}$, such that $n$ is
  composite. Consider $a = 2$ and $n = 341$. Note that
  $341 = 11\cdot31$, and $(2,341) = 1$. Since
  $2^{10} = 1024 \equiv 1\pmod{341}$, we have
  \begin{equation*}
    2^{340} = (2^{10})^{34} \equiv 1\pmod{341}.
  \end{equation*}
  This gives us a counterexample for the converse of Fermat's Theorem.
\end{solution}
