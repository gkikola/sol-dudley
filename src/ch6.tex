\chapter{Fermat's and Wilson's Theorems}

\section{Exercises}

\Exercise1 Verify that Fermat's Theorem is true for $a = 2$ and $p = 5$.
\begin{solution}
  We have $a^{p-1} = 2^4 = 16 \equiv 1 \pmod 5$, so the theorem holds.
\end{solution}

\Exercise2 Calculate $2^2$ and $20^{10}\pmod{11}$.
\begin{solution}
  $2^2\equiv4\pmod{11}$. To find $20^{10}$, we note that
  $20^2 = 400 \equiv 4\pmod{11}$. Squaring gives
  $20^4\equiv16\equiv5\pmod{11}$. Squaring again gives
  $20^8\equiv25\equiv3\pmod{11}$. So
  \begin{equation*}
    20^{10} = 20^8\cdot20^2 \equiv 3\cdot4 \equiv 1 \pmod{11}.\qedhere
  \end{equation*}
\end{solution}

\Exercise3 In the proof of Wilson's Theorem, what are the pairs when
$p = 11$?
\begin{solution}
  To find the multiplicative inverse of $2$, we look for the least
  residue satisfying the congruence $2x\equiv1\pmod{11}$. Since
  $1\equiv12\pmod{11}$, we may divide by $2$ to get
  $x\equiv6\pmod{11}$. Hence $(2,6)$ is one such pair. In the same way
  we can find the remaining pairs. The complete list of pairs follows:
  \begin{equation*}
    (2,6), (3,4), (5,9), (7,8). \qedhere
  \end{equation*}
\end{solution}

\section{Problems}

\Problem1 What is the least residue of
\begin{equation*}
  5^6\pmod7 \qquad 5^8\pmod7 \qquad 1945^8\pmod7?
\end{equation*}
\begin{solution}
  By Fermat's Theorem, $5^6\equiv1\pmod7$.

  $5^8 = 5^6\cdot5^2 \equiv 1\cdot4 \equiv 4\pmod7$.

  Again by Fermat, $1945^6\equiv1\pmod7$. Therefore
  \begin{equation*}
    1945^8\equiv1945^2
    = 5^2\cdot389^2 \equiv 4\cdot4^2 = 64\equiv1\pmod7.
    \qedhere
  \end{equation*}
\end{solution}

\Problem2 What is the least residue of
\begin{equation*}
  5^{10}\pmod{11} \qquad 5^{12}\pmod{11} \qquad 1945^{12}\pmod{11}?
\end{equation*}
\begin{solution}
  $5^{10}\equiv1\pmod{11}$ by Fermat's Theorem. So
  $5^{12} \equiv 5^2 \equiv 3\pmod{11}$.

  By Fermat, $1945^{10}\equiv1\pmod{11}$, so
  $1945^{12}\equiv1945^2\equiv9^2\equiv4\pmod{11}$.
\end{solution}

\Problem3 What is the last digit of $7^{355}$?
\begin{solution}
  We wish to find the least residue of $7^{355}$ modulo $10$. Note
  that $7^2 = 49 \equiv 9\pmod{10}$ and
  $7^4\equiv81\equiv1\pmod{10}$. So we have
  \begin{equation*}
    7^{355} = (7^4)^{88}\cdot7^3 \equiv 7^3 \equiv 3 \pmod {10}.
  \end{equation*}
  Therefore the last digit of $7^{355}$ is $3$.
\end{solution}

\Problem4 What are the last two digits of $7^{355}$?
\begin{solution}
  This is handled similarly to the previous problem, except now we are
  working modulo $100$. $7^3 = 343 \equiv 43\pmod{100}$, so
  $7^4\equiv301\equiv1\pmod{100}$. We find
  \begin{equation*}
    7^{355} = (7^4)^{88}\cdot7^3 \equiv 7^3 \equiv 43\pmod{100}.
  \end{equation*}
  The last two digits are therefore $4$ and $3$.
\end{solution}

\Problem5 What is the remainder when $314^{162}$ is divided by $163$?
\begin{solution}
  Since $314$ is not a multiple of $163$, which is prime, we may apply
  Fermat's Theorem to see that $314^{162}\equiv1\pmod{163}$.
\end{solution}

\Problem6 What is the remainder when $314^{162}$ is divided by $7$?
\begin{solution}
  As in the previous problem, since we know $314$ is not a multiple of
  $7$, we have by Fermat that $314^6\equiv1\pmod7$. Therefore
  \begin{equation*}
    314^{162} = (314^6)^{27} \equiv 1\pmod7. \qedhere
  \end{equation*}
\end{solution}

\Problem7 What is the remainder when $314^{164}$ is divided by $165$?
\begin{solution}
  Note that $165 = 3\cdot5\cdot11$. And we have
  \begin{align*}
    314^{164}\equiv2^{164}\equiv(2^4)^{41} &\equiv 1\pmod3, \\
    314^{164}\equiv4^{164}\equiv(4^4)^{41} &\equiv 1\pmod5, \\
    \intertext{and}
    314^{164}\equiv6^{164}\equiv(6^4)^{41} &\equiv 9\pmod{11}.
  \end{align*}
  We may now use the Chinese Remainder Theorem to solve the system of
  congruences given by
  \begin{equation*}
    x \equiv 1\pmod{15} \qquad\text{and}\qquad x \equiv 9 \pmod{11}.
  \end{equation*}
  This system admits the unique solution
  $x\equiv31\pmod{165}$. Therefore $31$ is the remainder we seek.
\end{solution}

\Problem8 What is the remainder when $2001^{2001}$ is divided by $26$?
\begin{solution}
  Since $2001\equiv25\equiv-1\pmod{26}$ we have
  \begin{equation*}
    2001^{2001}\equiv(-1)^{2001}\equiv-1\equiv25\pmod{26}.
  \end{equation*}
  Therefore the remainder is $25$.
\end{solution}

\Problem9 Show that
\begin{equation*}
  (p - 1)(p - 2)\cdots(p - r) \equiv (-1)^rr!\pmod p,
\end{equation*}
for $r = 1, 2, \dots, p - 1$.
\begin{proof}
  Fix an integer $p > 1$. We will prove the statement for all positive
  $r$ using induction on $r$. When $r = 1$, we have
  $p - 1 \equiv -1 \pmod{p}$, and certainly $-1 = (-1)^1(1!)$, so the
  statement holds in the base case.

  Now, suppose the statement holds for $r = k$ with
  $k\geq1$. Then $p - k - 1\equiv -(k + 1)\pmod{p}$ and we have
  \begin{equation*}
    (p - 1)\cdots(p - k)(p - k - 1)
    \equiv-(-1)^kk!(k + 1) \equiv (-1)^{k+1}(k+1)!\pmod{p}.
  \end{equation*}
  Therefore the statement holds for $r = k + 1$, which completes the
  proof.
\end{proof}
