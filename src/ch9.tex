\chapter{Euler's Theorem and Function}

\section{Exercises}

\Exercise1 Show that $a^6\equiv1\pmod{14}$ for all $a$ relatively
prime to $14$.
\begin{solution}
  The least residues that are relatively prime to $14$ are $1$, $3$,
  $5$, $9$, $11$, and $13$. We compute:
  \begin{align*}
    3^6 &= 27^2 \equiv (-1)^2 \equiv 1\pmod{14}, \\
    5^6 &= 25^3 \equiv (-3)^3 \equiv 1\pmod{14}, \\
    9^6 &= (3^6)^2 \equiv 1\pmod{14}, \\
    11^6 &\equiv (-3)^6 \equiv 1\pmod{14}, \\
    \intertext{and}
    13^6 &\equiv (-1)^6 \equiv 1\pmod{14}.
  \end{align*}
  In every case, $(a,14) = 1$ implies $a^6\equiv1\pmod{14}$.
\end{solution}

\Exercise2 Verify that Lemma~1 is true if $m = 14$ and $a = 5$.
\begin{solution}
  Again, the relatively prime positive integers less than $14$ are
  $1$, $3$, $5$, $9$, $11$, and $13$.
  \begin{align*}
    5\cdot1 &= 5 \equiv 5\pmod{14}, \\
    5\cdot3 &= 15 \equiv 1\pmod{14}, \\
    5\cdot5 &= 25 \equiv 11\pmod{14}, \\
    5\cdot9 &= 45 \equiv 3\pmod{14}, \\
    5\cdot11 &= 55 \equiv 13\pmod{14}, \\
    \intertext{and}
    5\cdot13 &= 65 \equiv 9\pmod{14}.
  \end{align*}
  And, certainly, $(5,1,11,3,13,9)$ is a permutation of
  $\{1,3,5,9,11,13\}$.
\end{solution}

\Exercise3 Verify that the entries in the following table are correct.
\begin{center}
  \begin{tabular}{r|rrrrrrrrr}
    $n$ & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 \\
    $\phi(n)$ & 1 & 2 & 2 & 4 & 2 & 6 & 4 & 6 & 4
  \end{tabular}
\end{center}
\begin{solution}
  The verification is straightforward. We simply count the number of
  positive integers that are relatively prime to $n$ and less than or
  equal to $n$. For example, when $n = 8$ the relatively prime
  residues are $1$, $3$, $5$, and $7$, so $\phi(8) = 4$. The other
  values are checked in the same way.
\end{solution}

\Exercise4 Verify that $3^{\phi(8)}\equiv1\pmod8$.
\begin{solution}
  Since $\phi(8) = 4$, we have $3^4 = 9^2 \equiv 1^2 \equiv 1\pmod8$.
\end{solution}

\Exercise5 Which positive integers are less than $4$ and relatively
prime to it? What is the answer if $4$ is replaced by $8$? By $16$?
Can you induce a formula for $\phi(2^n)$, $n = 1,2,\dots$?
\begin{solution}
  For $4$ the numbers are $1$ and $3$. For $8$ they are $1$, $3$, $5$,
  and $7$. For $16$, they are $1$, $3$, $5$, $7$, $9$, $11$, $13$, and
  $15$. So we have $\phi(4) = 2$, $\phi(8) = 4$, and $\phi(16) = 8$.

  In general, it looks like $\phi(2^n) = 2^{n-1}$ for each positive
  $n$. To prove this, note that there are $2^n$ positive integers less
  than or equal to $2^n$. Exactly half of these numbers will be even
  and thus not relatively prime to $2^n$. So
  \begin{equation*}
    \phi(2^n) = \frac12(2^n) = 2^{n-1}. \qedhere
  \end{equation*}
\end{solution}

\Exercise6 Verify that the formula of Lemma~2 is correct for $p = 5$
and $n = 2$.
\begin{solution}
  According to Lemma~2, $\phi(5^2) = 5^1(5 - 1) = 20$. The positive
  integers less than or equal to $5^2$ that are not relatively prime
  to it are $5$, $10$, $15$, $20$, and $25$, so
  $\phi(5^2) = 25 - 5 = 20$ and the formula works in this case.
\end{solution}

\Exercise7 In the proof of Theorem~2, how many rows are there whose
first element is relatively prime to $m$?
\begin{solution}
  There are exactly $\phi(m)$ such rows.
\end{solution}

\Exercise8 Calculate $\phi(74)$, $\phi(76)$, and $\phi(78)$.
\begin{solution}
  Using Theorem~3, we get
  \begin{align*}
    \phi(74) &= \phi(2)\phi(37) = (1\cdot1)(1\cdot36) = 36, \\
    \phi(76) &= \phi(2^2)\phi(19)
               = (2\cdot1)(1\cdot18) = 36, \\
    \intertext{and}
    \phi(78) &= \phi(2)\phi(3)\phi(13)
               = (1\cdot1)(1\cdot2)(1\cdot12) = 24. \qedhere
  \end{align*}
\end{solution}

\Exercise9 Calculate $\displaystyle\sum_{d\mid n}\phi(d)$
\begin{enumerate}
\item For $n = 12$, $13$, $14$, $15$, and $16$.
  \begin{solution}
    For $n = 12$, we have
    \begin{align*}
      \sum_{d\mid12}\phi(d)
      &= \phi(1) + \phi(2) + \phi(3) + \phi(4) + \phi(6) + \phi(12) \\
      &= 1 + 1 + 2 + 2 + 2 + 4 = 12.
    \end{align*}
    In the same manner, we can compute the rest of the values. In each
    case, we find that
    \begin{equation*}
      \sum_{d\mid n}\phi(d) = n. \qedhere
    \end{equation*}
  \end{solution}
\item For $n = 2^k$, $k\geq1$.
  \begin{solution}
    The positive divisors of $2^k$ are $1,2,4,\dots,2^k$. So
    \begin{align*}
      \sum_{d\mid2^k}\phi(d)
      &= \sum_{i=0}^k\phi(2^i) \\
      &= \phi(1) + \sum_{i=1}^k2^{i-1} \\
      &= 1 + (2^k - 1)
        = 2^k \\
      &= n. \qedhere
    \end{align*}
  \end{solution}
\item For $n = p^k$, $k\geq1$ and $p$ an odd prime.
  \begin{solution}
    The positive divisors of $n$ are $1, p, p^2, \dots, p^k$, so
    \begin{align*}
      \sum_{d\mid p^k}\phi(d)
      &= \sum_{i=0}^k\phi(p^i) \\
      &= 1 + \sum_{i=1}^kp^{i-1}(p - 1) \\
      &= 1 + \sum_{i=1}^kp^i - \sum_{i=1}^kp^{i-1} \\
      &= 1 + \left(p^k + \sum_{i=1}^{k-1}p^i\right)
        - \left(1 + \sum_{i=1}^{k-1}p^i\right) \\
      &= p^k = n. \qedhere
    \end{align*}
  \end{solution}
\end{enumerate}

\Exercise{10} In the proof of Theorem~4, what are the classes $C_d$
for $n = 14$?
\begin{solution}
  We have
  \begin{align*}
    C_1 &= \{1,3,5,9,11,13\}, \\
    C_2 &= \{2,4,6,8,10,12\}, \\
    C_7 &= \{7\}, \\
    \intertext{and}
    C_{14} &= \{14\}. \qedhere
  \end{align*}
\end{solution}

\Exercise{11} Check that the number of elements in class $C_d$ is
$\phi(n/d)$ for $n = 12$ and $n = 14$.
\begin{solution}
  For $n = 12$:
  \begin{align*}
    C_1 &= \{1,5,7,11\}, & \phi(12) &= 4, \\
    C_2 &= \{2,10\}, & \phi(6) &= 2, \\
    C_3 &= \{3,9\}, & \phi(4) &= 2, \\
    C_4 &= \{4,8\}, & \phi(3) &= 2, \\
    C_6 &= \{6\}, & \phi(2) &= 1, \\
    C_{12} &= \{12\}, & \phi(1) &= 1.
  \end{align*}
  In each case, we see that $C_d$ has exactly $\phi(n/d)$ elements.

  Similarly, for $n = 14$, $\phi(14) = 6$, $\phi(7) = 6$,
  $\phi(2) = 1$, and $\phi(1) = 1$, and we see that these numbers
  match the size of the sets found in the previous exercise.
\end{solution}

\section{Problems}

\Problem1 Calculate $\phi(42)$, $\phi(420)$, and $\phi(4200)$.
\begin{solution}
  We have
  \begin{align*}
    \phi(42) &= \phi(2)\phi(3)\phi(7) = 1\cdot2\cdot6 = 12 \\
    \phi(420) &= \phi(2^2)\phi(3)\phi(5)\phi(7)
                = 2\cdot2\cdot4\cdot6 = 96 \\
    \intertext{and}
    \phi(4200) &= \phi(2^3)\phi(3)\phi(5^2)\phi(7)
                 = 4\cdot2\cdot20\cdot6 = 960. \qedhere
  \end{align*}
\end{solution}

\Problem2 Calculate $\phi(54)$, $\phi(540)$, and $\phi(5400)$.
\begin{solution}
  \begin{align*}
    \phi(54) &= \phi(2)\phi(3^3) = 1\cdot18 = 18, \\
    \phi(540) &= \phi(2^2)\phi(3^3)\phi(5)
                = 2\cdot18\cdot4 = 144, \\
    \intertext{and}
    \phi(5400) &= \phi(2^3)\phi(3^3)\phi(5^2)
                 = 4\cdot18\cdot20 = 1440. \qedhere
  \end{align*}
\end{solution}

\Problem3 Calculate $\phi$ of $10115 = 5\cdot7\cdot17^2$ and
$100115 = 5\cdot20023$.
\begin{solution}
  \begin{align*}
    \phi(10115) &= \phi(5)\phi(7)\phi(17^2) \\
                &= 4\cdot6\cdot17(17-1) \\
                &= 24\cdot17\cdot16 \\
                &= 6528
  \end{align*}
  and
  \begin{align*}
    \phi(100115) &= \phi(5)\phi(20023) \\
                 &= 4\cdot20022 \\
                 &= 80088. \qedhere
  \end{align*}
\end{solution}

\Problem4 Calculate $\phi$ of $10116 = 2^2\cdot3^2\cdot281$ and
$100116 = 2^2\cdot3^5\cdot103$.
\begin{solution}
  \begin{align*}
    \phi(10116) &= \phi(2^2)\phi(3^2)\phi(281) \\
                &= 2\cdot6\cdot280 \\
                &= 3360
  \end{align*}
  and
  \begin{align*}
    \phi(100116) &= \phi(2^2)\phi(3^5)\phi(103) \\
                 &= 2\cdot3^4(2)\cdot102 \\
                 &= 324\cdot102 \\
                 &= 33048. \qedhere
  \end{align*}
\end{solution}

\Problem5 Calculate $a^8\pmod{15}$ for $a = 1,2,\dots,14$.
\begin{solution}
  Since $\phi(15) = \phi(3)\phi(5) = 2\cdot4 = 8$, we know
  $a^8\equiv1\pmod{15}$ for each $a$ such that $(a,15) = 1$. For the
  remaining values, we have
  \begin{align*}
    3^8 &= (3^4)^2 \equiv 6^2 \equiv 6\pmod{15}, \\
    5^8 &= (5^2)^4 \equiv 10^4 \equiv 10^2 \equiv 10\pmod{15}, \\
    6^8 &= 2^83^8 \equiv 6\cdot16^4 \equiv 6\pmod{15}, \\
    9^8 &= (3^8)^2 \equiv 36 \equiv 6 \pmod{15}, \\
    10^8 &= (10^4)^2 \equiv 10^2 \equiv 10\pmod{15}, \\
    \intertext{and}
    12^8 &= 3^84^8 \equiv 6\cdot(2^4)^4 \equiv 6\pmod{15}. \qedhere
  \end{align*}
\end{solution}

\Problem6 Calculate $a^8\pmod{16}$ for $a = 1,2,\dots,15$.
\begin{solution}
  $\phi(16) = 8$, so $a^8\equiv1\pmod{16}$ for all $a$ such that
  $(a,16) = 1$. The remaining values are all even, and since $2^8$
  contains a factor of $16$, we will get $a^8\equiv0\pmod{16}$ for
  each $a$ such that $(a,16) > 1$.
\end{solution}

\Problem7 Show that if $n$ is odd, then $\phi(4n) = 2\phi(n)$.
\begin{proof}
  Since $n$ is odd, we know $(4,n) = 1$, so the multiplicativity of
  $\phi$ gives
  \begin{equation*}
    \phi(4n) = \phi(4)\phi(n) = 2\phi(n). \qedhere
  \end{equation*}
\end{proof}

\Problem8 Perfect numbers satisfy $\sigma(n) = 2n$. Which $n$ satisfy
$\phi(n) = 2n$?
\begin{solution}
  There are no positive integers $n$ with $\phi(n) = 2n$, for the
  simple reason that there are only $n$ positive integers less than or
  equal to $n$ in the first place. So $\phi(n) \leq n$ for all $n$.
\end{solution}

\Problem9 $1 + 2 = (3/2)\phi(3)$, $1 + 3 = (4/2)\phi(4)$,
$1 + 2 + 3 + 4 = (5/2)\phi(5)$, $1 + 5 = (6/2)\phi(6)$,
$1 + 2 + 3 + 4 + 5 + 6 = (7/2)\phi(7)$, and
$1 + 3 + 5 + 7 = (8/2)\phi(8)$. Guess a theorem.
\begin{solution}
  For each positive integer $n > 1$, the sum of the positive integers
  less than or equal to $n$ which are relatively prime to $n$ is
  $(n/2)\phi(n)$.

  To prove this, let $T$ be the set of positive integers less than or
  equal to $n$ and relatively prime to it, so that
  $T = \{t_1,t_2,t_3,\dots,t_{\phi(n)}\}$.

  Take the number $t_i$ for some $i$. Then $(t_i,n) = 1$ and, by
  Theorem~4 of Section~1, there are integers $x$ and $y$ with
  \begin{equation*}
    t_ix + ny = 1.
  \end{equation*}
  But by setting $a = -x$ and $b = x + y$, this equation becomes
  \begin{equation*}
    a(n - t_i) + bn = 1,
  \end{equation*}
  so that $(n - t_i, n) = 1$ and $(n - t_i)\in T$. We see that
  $t_i\in T$ if and only if $n - t_i\in T$.

  Now let $S$ be the sum of the members of $T$. Then
  \begin{equation}
    \label{eq:euler:sum-of-totatives1}
    S = t_1 + t_2 + t_3 + \cdots + t_{\phi(n)}.
  \end{equation}
  On the other hand, we can also write
  \begin{equation}
    \label{eq:euler:sum-of-totatives2}
    S = (n - t_1) + (n - t_2) + (n - t_3) + \cdots + (n - t_{\phi(n)}).
  \end{equation}
  Adding equations \eqref{eq:euler:sum-of-totatives1} and
  \eqref{eq:euler:sum-of-totatives2} together then gives
  \begin{equation*}
    2S = n\phi(n)
  \end{equation*}
  and dividing by $2$ gives the desired result.
\end{solution}

\Problem{10} Show that
\begin{equation*}
  \sum_{p\leq x}\sigma(p) - \sum_{p\leq x}\phi(p) = \sum_{p\leq x}d(p),
\end{equation*}
where each sum is over the primes less than or equal to $x$.
\begin{proof}
  Note that for any prime $p$, $\sigma(p) = p + 1$, $\phi(p) = p - 1$,
  and $d(p) = 2$. So we have
  \begin{align*}
    \sum_{p\leq x}\sigma(p) - \sum_{p\leq x}\phi(p)
    &= \sum_{p\leq x}(p + 1) - \sum_{p\leq x}(p - 1) \\
    &= \sum_{p\leq x}2 \\
    &= \sum_{p\leq x}d(p). \qedhere
  \end{align*}
\end{proof}

\Problem{11} Prove Lemma~3 by starting with the fact that there are
integers $r$ and $s$ such that $ar + ms = 1$.
\begin{proof}
  We want to show that if $(a,m) = 1$ and $a\equiv b\pmod{m}$, then
  $(b,m) = 1$. Since $ar + ms = 1$, we have
  \begin{equation*}
    1 \equiv ar \equiv br \pmod{m},
  \end{equation*}
  which implies that $br + km = 1$ for some integer $k$. This is
  enough to show that $(b,m) = 1$.
\end{proof}

\Problem{12} If $(a,m) = 1$, show that any $x$ such that
\begin{equation}
  \label{eq:euler:x-equiv-ca-to-phi-m-minus-1}
  x\equiv ca^{\phi(m)-1}\pmod{m}
\end{equation}
satisfies $ax\equiv c\pmod{m}$.
\begin{proof}
  Let $x$ satisfy
  \eqref{eq:euler:x-equiv-ca-to-phi-m-minus-1}. Multiplying both sides
  of this congruence by $a$ gives
  \begin{equation*}
    ax \equiv ca^{\phi(m)}\pmod{m},
  \end{equation*}
  and since $(a,m) = 1$, we have $ca^{\phi(m)}\equiv c\pmod{m}$ by
  Euler's Theorem.
\end{proof}

\Problem{13} Let $f(n) = (n + \phi(n))/2$. Show that
$f(f(n)) = \phi(n)$ if $n = 2^k$, $k = 3, 4, 5, \dots$.
\begin{proof}
  We compute
  \begin{align*}
    f(2^k) &= \frac{2^k + \phi(2^k)}2 \\
           &= \frac{2^k + 2^{k-1}}2 \\
           &= 2^{k-1} + 2^{k-2} \\
           &= 2^{k-2}(2 + 1) \\
           &= 2^{k-2}\cdot3.
  \end{align*}
  So,
  \begin{align*}
    f(f(2^k)) &= f(2^{k-2}\cdot3) \\
              &= \frac{2^{k-2}\cdot3 + \phi(2^{k-2})\phi(3)}2 \\
              &= \frac{2^{k-2}\cdot3 + 2^{k-3}\cdot2}2 \\
              &= 2^{k-3}\cdot3 + 2^{k-3} \\
              &= 2^{k-3}(3 + 1) \\
              &= 2^{k-1} \\
              &= \phi(2^k).
  \end{align*}
  We see that $f(f(2^k)) = \phi(2^k)$ for all $k\geq3$.
\end{proof}

\Problem{14} Find four solutions of $\phi(n) = 16$.
\begin{solution}
  Since $3 - 1 = 2$, $5 - 1 = 4$, and $17 - 1 = 16$, solutions should
  have the form $2^a3^b5^c17^d$ for some nonnegative integers
  $a,b,c,d$. By inspection, we find
  \begin{align*}
    \phi(17) &= 16, \\
    \phi(32) &= \phi(2^5) = 16, \\
    \phi(34) &= \phi(2)\phi(17) = 1\cdot16 = 16, \\
    \phi(40) &= \phi(2^3)\phi(5) = 4\cdot4 = 16, \\
    \phi(48) &= \phi(2^4)\phi(3) = 8\cdot2 = 16, \\
    \intertext{and}
    \phi(60) &= \phi(2^2)\phi(3)\phi(5) = 2\cdot2\cdot4 = 16. \qedhere
  \end{align*}
\end{solution}

\Problem{15} Find all solutions of $\phi(n) = 4$ and prove that there
are no more.
\begin{solution}
  Let $n$ be a solution, and let
  $n = p_1^{e_1}p_2^{e_2}\cdots p_k^{e_k}$ be the prime-power
  decomposition of $n$. Then
  \begin{equation*}
    \phi(n) = p_1^{e_1 - 1}(p_1 - 1)p_2^{e_2 - 1}(p_2 - 1)
    \cdots p_k^{e_k - 1}(p_k - 1) = 4.
  \end{equation*}
  Each factor in this expression must be either $1$, $2$, or $4$. If
  \begin{equation*}
    p_i^{e_i - 1}(p_i - 1) = 1,
  \end{equation*}
  then $p_i = 2$ and $e_i = 1$. If
  \begin{equation*}
    p_i^{e_i - 1}(p_i - 1) = 2,
  \end{equation*}
  then either $p_i = 2$ and $e_i = 2$ or $p_i = 3$ and $e_i = 1$. And
  if
  \begin{equation*}
    p_i^{e_i - 1}(p_i - 1) = 4,
  \end{equation*}
  then either $p_i = 2$ and $e_i = 3$ or $p_i = 5$ and $e_i = 1$. We
  can see that these are the only possibilities. Thus we have the
  following solutions.
  \begin{align*}
    \phi(5) &= 4, \\
    \phi(8) &= \phi(2^3) = 2^2 = 4, \\
    \phi(10) &= \phi(2)\phi(5) = 1\cdot4 = 4, \\
    \intertext{and}
    \phi(12) &= \phi(2^2)\phi(3) = 2\cdot2 = 4.
  \end{align*}
  As we have ruled out all other possibilities, these are the only
  solutions.
\end{solution}
