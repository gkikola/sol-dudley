\chapter{Perfect Numbers}

\section{Exercises}

\Exercise1 Verify that $1184$ and $1210$ are amicable.
\begin{solution}
  $1184 = 2^5\cdot37$ and $1210 = 2\cdot5\cdot11^2$, so
  \begin{equation*}
    \sigma(1184) = \sigma(2^5)\sigma(37)
    = (2^6 - 1)(38) = 63\cdot38 = 2394
  \end{equation*}
  and
  \begin{equation*}
    \sigma(1210) = \sigma(2)\sigma(5)\sigma(11^2)
    = 3\cdot6\cdot(1 + 11 + 121) = 18\cdot133
    = 2394.
  \end{equation*}
  Since $1184 + 1210 = 2394$, we see that the two numbers form an
  amicable pair.
\end{solution}

\section{Problems}

\Problem1 Verify that $2620, 2924$ and $17296,18416$ are amicable pairs.
\begin{solution}
  $2620 = 2^2\cdot5\cdot131$ and $2924 = 2^2\cdot17\cdot43$. We get
  \begin{equation*}
    \sigma(2620) = 7\cdot6\cdot132 = 5544
  \end{equation*}
  and
  \begin{equation*}
    \sigma(2924) = 7\cdot18\cdot44 = 5544,
  \end{equation*}
  and $2620 + 2924 = 5544$, so the two are amicable.

  For $17296$ we have
  \begin{equation*}
    \sigma(17296) = \sigma(2^4\cdot23\cdot47)
    = 31\cdot24\cdot48 = 35712
  \end{equation*}
  and for $18416$ we have
  \begin{equation*}
    \sigma(18416) = \sigma(2^4\cdot1151)
    = 31\cdot1152 = 35712,
  \end{equation*}
  and $17296 + 18416 = 35712$, so these two are also amicable.
\end{solution}

\Problem2 It was long thought that even perfect numbers ended
alternately in $6$ and $8$. Show that this is wrong by verifying that
the perfect numbers corresponding to the primes $2^{13} - 1$ and
$2^{17} - 1$ both end in $6$.
\begin{proof}
  First note that $2^8 = 256\equiv6\pmod{10}$ so
  $2^{16}\equiv6^2\equiv6\pmod{10}$, and
  $2^{12} = 2^8\cdot2^4\equiv6\cdot6\equiv6\pmod{10}$.

  For $p = 13$, we have
  \begin{equation*}
    2^{p-1}(2^p - 1)
    = 2^{12}(2^{13} - 1)
    \equiv 6\cdot(6\cdot2 - 1)
    \equiv6\pmod{10}
  \end{equation*}
  and for $p = 17$ we have
  \begin{equation*}
    2^{16}(2^{17} - 1)
    = 6\cdot(6\cdot2 - 1)
    \equiv6\pmod{10}.
  \end{equation*}
  In both cases, we see that the corresponding perfect numbers end in
  $6$.
\end{proof}

\Problem3 Classify the integers $2,3,\dots,21$ as abundant, deficient,
or perfect.
\begin{solution}
  The values of $\sigma(n)$ for $n = 1,\dots,14$ are listed in the
  table from Exercise~\ref{exercise:divisors:sigma-table}. The
  remaining values are as follows:
  \begin{align*}
    \sigma(15) &= \sigma(3)\sigma(5) = 4\cdot6 = 24, \\
    \sigma(16) &= \sigma(2^4) = 2^5 - 1 = 31, \\
    \sigma(17) &= 18, \\
    \sigma(18) &= \sigma(2)\sigma(3^2) = 3\cdot(1 + 3 + 9) = 39, \\
    \sigma(19) &= 20, \\
    \sigma(20) &= \sigma(2^2)\sigma(5) = (2^3 - 1)\cdot6 = 42, \\
    \sigma(21) &= \sigma(3)\sigma(7) = 4\cdot8 = 32.
  \end{align*}

  From these values, we determine that the only perfect number between
  $2$ and $21$ is $6$. The only abundant numbers between $2$ and $21$
  are $12$, $18$, and $20$. And the remaining values are all
  deficient.
\end{solution}

\Problem4 Classify the integers $402, 403, \dots, 421$ as abundant,
deficient, or perfect.
\begin{solution}
  The calculations for $\sigma(n)$ are similar to those in the
  previous problem. We find that, in this range, there are no perfect
  numbers and the only abundant numbers are $402$, $408$, $414$,
  $416$, and $420$. The remaining numbers are deficient.
\end{solution}

\Problem5 If $\sigma(n) = kn$, then $n$ is called a {\em $k$-perfect
  number}. Verify that $672$ is $3$-perfect, and
$\text{2,178,540} = 2^2\cdot3^2\cdot5\cdot7^2\cdot13\cdot19$ is
$4$-perfect.
\begin{solution}
  We compute
  \begin{equation*}
    \sigma(672) = \sigma(2^5)\sigma(3)\sigma(7)
    = 63\cdot4\cdot8
    = 2016 = 3\cdot672,
  \end{equation*}
  showing that $672$ is $3$-perfect. For 2,178,540 we get
  \begin{align*}
    \sigma(2\,178\,540)
    &= \sigma(2^2)\sigma(3^2)\sigma(5)\sigma(7^2)\sigma(13)\sigma(19) \\
    &= 7\cdot13\cdot6\cdot57\cdot14\cdot20 \\
    &= 8\,714\,160 \\
    &= 4\cdot2\,178\,540,
  \end{align*}
  showing that it is $4$-perfect.
\end{solution}

\Problem6 Show that no number of the form $2^a3^b$ is $3$-perfect.
\begin{proof}
  Let $n = 2^a3^b$ for some nonnegative integers $a$ and $b$. Then
  \begin{align*}
    \sigma(n) = \sigma(2^a)\sigma(3^b)
    &= (2^{a+1} - 1)\cdot\frac{3^{b+1} - 1}2 \\
    &= \frac12(2^{a+1}3^{b+1} - 2^{a+1} - 3^{b+1} + 1) \\
    &= \frac12(6n - 2^{a+1} - 3^{b+1} + 1) \\
    &= 3n - \frac12(2^{a+1} + 3^{b+1} - 1).
  \end{align*}
  Now suppose $n$ is $3$-perfect. Then $\sigma(n) = 3n$ and we get
  \begin{equation*}
    2^{a+1} + 3^{b+1} - 1 = 0.
  \end{equation*}
  But $a,b\geq0$, so the left-hand side has to be at least
  $2 + 3 - 1 = 4$. This contradiction shows that no such $n$ is
  $3$-perfect.
\end{proof}

\Problem7 Let us say that $n$ is {\em superperfect}\/ if and only if
$\sigma(\sigma(n)) = 2n$. Show that if $n = 2^k$ and $2^{k+1} - 1$ is
prime, then $n$ is superperfect.
\begin{proof}
  Let $n = 2^k$ for some positive integer $k$ and suppose
  $2^{k+1} - 1$ is prime. Then
  \begin{equation*}
    \sigma(\sigma(n)) = \sigma(2^{k+1} - 1) = (2^{k+1} - 1) + 1
    = 2^{k+1} = 2n
  \end{equation*}
  and $n$ is superperfect.
\end{proof}

\Problem8 It was long thought that every abundant number was
even. Show that $945$ is abundant, and find another abundant number of
the form $3^a\cdot5\cdot7$.
\begin{solution}
  We have
  \begin{equation*}
    \sigma(945)
    = \sigma(3^3)\sigma(5)\sigma(7)
    = (1 + 3 + 9 + 27)\cdot6\cdot8
    = 40\cdot48
    = 1920,
  \end{equation*}
  and since $1920 > 1890 = 2\cdot945$, we see that $945$ is indeed
  abundant.

  Another odd abundant number is $2835 = 3^4\cdot5\cdot7$. Then
  \begin{equation*}
    \sigma(2835) = 5808 > 2\cdot2835 = 5670. \qedhere
  \end{equation*}
\end{solution}

\Problem9 In 1575, it was observed that every even perfect number is a
triangular number. Show that this is so.
\begin{proof}
  Let $n$ be a perfect number, so that $n = 2^{p-1}(2^p - 1)$ where
  $p$ and $2^p-1$ are prime. Then we may write
  \begin{equation*}
    n = \frac{2^p(2^p - 1)}2 = \frac{k(k + 1)}2,
  \end{equation*}
  where $k = 2^p - 1$ is an integer. This shows that $n$ is triangular.
\end{proof}

\Problem{10} In 1652, it was observed that
\begin{align*}
  6 &= 1 + 2 + 3, \\
  28 &= 1 + 2 + 3 + 4 + 5 + 6 + 7, \\
  496 &= 1 + 2 + 3 + \cdots + 31.
\end{align*}
Can this go on?
\begin{solution}
  Yes, every perfect number $n$ can be written as the sum
  \begin{equation*}
    n = 1 + 2 + 3 + \cdots + k
  \end{equation*}
  for some positive integer $k$. The reason for this is because every
  perfect number is triangular, as was shown in the previous problem,
  and every triangular number can be written in the form
  \begin{equation*}
    \sum_{k=1}^nk = \frac{n(n+1)}2.
  \end{equation*}
  This is easy to prove by induction.
\end{solution}

\Problem{11} Let
\begin{align*}
  p &= 3\cdot2^e - 1, \\
  q &= 3\cdot2^{e-1} - 1, \\
  r &= 3^2\cdot2^{2e-1} - 1,
\end{align*}
where $e$ is a positive integer. If $p$, $q$, and $r$ are all prime,
show that $2^epq$ and $2^er$ are amicable.
\begin{proof}
  We will actually need to assume $e\geq2$ so that $p,q,r$ are odd
  primes ($e = 1$ produces $20$ and $34$, which are not
  amicable). Let $m = 2^epq$ and $n = 2^er$.

  Note that $p$, $q$, and $r$ must be distinct primes, and all are
  odd, so the four numbers $2^e$, $p$, $q$, and $r$ are all pairwise
  coprime. Then we may compute
  \begin{align*}
    \sigma(m)
    &= \sigma(2^e)\sigma(p)\sigma(q) \\
    &= (2^{e+1} - 1)(p + 1)(q + 1) \\
    &= (2^{e+1} - 1)(3\cdot2^e)(3\cdot2^{e-1}) \\
    &= 9\cdot2^{2e-1}(2^{e+1} - 1),
  \end{align*}
  and
  \begin{align*}
    \sigma(n)
    &= \sigma(2^e)\sigma(r) \\
    &= (2^{e+1} - 1)(r + 1) \\
    &= 9\cdot2^{2e-1}(2^{e+1} - 1).
  \end{align*}
  Since
  \begin{align*}
    m + n
    &= 2^e(pq + r) \\
    &= 2^e((3\cdot2^e - 1)(3\cdot2^{e-1} - 1) + (9\cdot2^{2e-1} - 1)) \\
    &= 2^e(2\cdot9\cdot2^{2e-1} - 3(2^e + 2^{e-1})) \\
    &= 2^e(9\cdot2^{2e} - 9\cdot2^{e-1}) \\
    &= 9\cdot2^{2e-1}(2^{e+1} - 1),
  \end{align*}
  we see that $\sigma(m) = \sigma(n) = m + n$ and the two numbers $m$
  and $n$ form an amicable pair.
\end{proof}
